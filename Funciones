DELIMITER $$

CREATE FUNCTION `dias_activos_de_rider` (rider_id INT)
RETURNS INT
READS SQL DATA
BEGIN

DECLARE dias_activo INT;
DECLARE fecha_de_inicio DATE;

SET fecha_de_inicio = (SELECT Fecha_de_inicio from riders
where riders.rider_id = rider_id
order by riders.fecha_de_inicio
LIMIT 1);

SET dias_activo = (SELECT DATEDIFF(CURDATE(), @Fecha_de_inicio) FROM DUAL); 

RETURN dias_activo;

END $$

DELIMITER ;


DELIMITER $$

CREATE FUNCTION `convertir_nombre_ciudad_en_city_id` (ciudad Varchar(50))
RETURNS INT
READS SQL DATA
BEGIN

DECLARE nombre_ciudad Varchar(50); 
DECLARE city_id INT;

SET nombre_ciudad = (Select ciudad from riders
LIMIT 1);
                    
SET city_id =   (SELECT city_id from riders
					inner join cities on riders.ciudad = cities.ciudad
                    order by riders.ciudad
                    LIMIT 1);                 

RETURN city_id;

END $$

DELIMITER ;
